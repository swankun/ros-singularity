Bootstrap: docker
From: ros:foxy-ros-base-focal
Stage: build

%files
    /home/wankun/Singularity/assets/ros2bashrc /

%post -c /bin/bash
    CUSTOM_ENV=/.singularity.d/env/99-zz_custom_env.sh
    cat >$CUSTOM_ENV <<EOF
#!/bin/bash
PS1='${debian_chroot:+($debian_chroot)}\[\033[01;32m\]\u@[ros2-foxy]\[\033[00m\]:\[\033[01;34m\]\w\[\033[00m\]\$ '
EOF
    chmod 755 $CUSTOM_ENV

    apt update && apt install -y --no-install-recommends ros-foxy-desktop=0.9.2-1*
    rm -rf /var/lib/apt/lists/*
    apt install -y python3-argcomplete

%runscript
    exec /bin/bash --rcfile /ros2bashrc "$@"